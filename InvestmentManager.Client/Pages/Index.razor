@page "/"
@inject CustomHttpClient http

<div class="container idark iframe">
    <div class="row">
        <div class="col-8"><span class="oi oi-dollar" aria-hidden="true"></span> сегодня:</div>
        @if (dollar.HasValue)
        {
            <div class="col-4 text-right font-weight-bold text-danger">@dollar.Value.ToString("C")</div>
        }
        else
        {
            <text>@DefaultData.loading</text>
        }
    </div>
</div>

<AdminFrame />
<AccountFrame />

@for (int i = 0; i < model.Count; i++)
{
    <CompanyFrame Id="@model[i].Id" Name="@model[i].Name" />
}


@code
{
    decimal? dollar;
    CBRF rate;
    List<CompanyModel> model = new List<CompanyModel>();

    protected override async Task OnInitializedAsync()
    {
        model = await http.GetResultAsync<List<CompanyModel>>("company/list");
        rate = await http.GetResultAsync<CBRF>("outside/getrate");
        dollar = rate.Valute.USD.Value;
    }
}
