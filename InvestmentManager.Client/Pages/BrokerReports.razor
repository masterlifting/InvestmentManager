@page "/brokerreports"
@inject ILocalStorageService localStorage
@inject Notification notice
@attribute [Authorize]

@if (ReportModel.ReportErrors.Any())
{
    <ReportErrors Errors="@ReportModel.ReportErrors" />
}
else if (ReportModel.CorrectReports.Any())
{
    <CorrectReports Reports="@ReportModel.CorrectReports.ToList()" />
}


@code
{
    BrokerReportModel ReportModel = new BrokerReportModel();
    [CascadingParameter] Task<AuthenticationState> AuthenticationState { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var user = (await AuthenticationState).User;
        ReportModel = await localStorage.GetItemAsync<BrokerReportModel>($"{user.Identity.Name}_bcsReport");
        notice.LoadStop();
        notice.ToastSuccess("Parsing bcs reports", "Success");
    }
}